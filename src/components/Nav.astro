---
import { t, langPrefix, type Lang } from "../i18n/ui";
interface Props { lang: Lang }
const { lang } = Astro.props;
const pre = langPrefix(lang);

const links = [
  { label: t(lang, "nav.howItWorks"), href: `${pre}/#how` },
  { label: t(lang, "nav.domains"), href: `${pre}/#domains` },
  { label: t(lang, "nav.developers"), href: `${pre}/#developers` },
  { label: t(lang, "nav.pricing"), href: `${pre}/#pricing` },
];

const otherLang = lang === "en" ? "sv" : "en";
const otherHref = otherLang === "en" ? "/" : "/sv/";
const flag = lang === "en" ? "ðŸ‡¸ðŸ‡ª" : "ðŸ‡¬ðŸ‡§";
---

<nav
  id="site-nav"
  class="fixed top-0 inset-x-0 z-50 transition-colors duration-300"
>
  <div class="mx-auto max-w-5xl px-6 flex items-center justify-between h-14">
    <a href={`${pre}/`} class="text-lg font-bold tracking-tight">{t(lang, "nav.brand")}</a>
    <div class="hidden sm:flex items-center gap-6">
      {links.map((link) => (
        <a
          href={link.href}
          class="text-sm font-medium opacity-80 hover:opacity-100 transition-opacity"
        >
          {link.label}
        </a>
      ))}
      <a
        href={`${pre}/#pilot`}
        class="text-sm font-semibold rounded-lg px-4 py-1.5 bg-white/15 hover:bg-white/25 transition-colors"
      >
        {t(lang, "nav.cta")}
      </a>
      <a
        href={otherHref}
        class="text-lg leading-none hover:scale-110 transition-transform"
        title={otherLang === "sv" ? "Svenska" : "English"}
      >
        {flag}
      </a>
    </div>
  </div>
</nav>

<script>
  const nav = document.getElementById("site-nav")!;
  const hero = document.querySelector("section")!;

  function updateNav() {
    const pastHero = window.scrollY > hero.offsetHeight - 60;
    nav.classList.toggle("bg-white", pastHero);
    nav.classList.toggle("shadow-sm", pastHero);
    nav.classList.toggle("text-barivia-dark", pastHero);
    nav.classList.toggle("text-white", !pastHero);
  }

  updateNav();
  window.addEventListener("scroll", updateNav, { passive: true });
</script>
